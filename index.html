import pygame
import random
import sys

pygame.init()

WIDTH, HEIGHT = 800, 600
WHITE = (255, 255, 255)
FPS = 30

screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Memory game")
clock = pygame.time.Clock()

correct_sound = pygame.mixer.Sound("correct.wav")
wrong_sound = pygame.mixer.Sound("wrong.wav")

correct_images = [f"correct_{i}.jpg" for i in range(49)]
incorrect_images = [f"incorrect_{i}.jpg" for i in range(49)]

rounds = []
for _ in range(30):
    correct_img = random.choice(correct_images)
    incorrect_img = random.choice(incorrect_images)
    correct_side = random.choice(["left", "right"])
    rounds.append((correct_img, incorrect_img, correct_side))

score = 0
font = pygame.font.SysFont(None, 48)
small_font = pygame.font.SysFont(None, 36)  # Smaller font for in-game display

def show_score():
    screen.fill(WHITE)
    text = font.render(f"Your Score: {score}/300", True, (0, 0, 0))
    screen.blit(text, (WIDTH // 2 - text.get_width() // 2, HEIGHT // 2))
    pygame.display.flip()
    pygame.time.wait(5000)

def display_game_info(current_round):
    round_text = small_font.render(f"Round: {current_round + 1}/30", True, (0, 0, 0))
    screen.blit(round_text, (20, 20))
    score_text = small_font.render(f"Score: {score}", True, (0, 0, 0))
    screen.blit(score_text, (WIDTH - 20 - score_text.get_width(), 20))

# تابع بازخورد با مکث فقط ۰.۵ ثانیه
def show_feedback(is_correct, current_score):
    screen.fill(WHITE)
    feedback_text = "درست!" if is_correct else "غلط!"
    color = (0, 170, 0) if is_correct else (220, 0, 0)
    text = font.render(feedback_text, True, color)
    score_display = small_font.render(f"امتیاز: {current_score}", True, (0, 0, 0))
    screen.blit(text, (WIDTH // 2 - text.get_width() // 2, HEIGHT // 2 - 40))
    screen.blit(score_display, (WIDTH // 2 - score_display.get_width() // 2, HEIGHT // 2 + 40))
    pygame.display.flip()
    pygame.time.wait(500)  # فقط ۰.۵ ثانیه مکث

current_round = 0
running = True

while running and current_round < 30:
    screen.fill(WHITE)

    correct_img_path, incorrect_img_path, correct_side = rounds[current_round]

    correct_img = pygame.image.load(correct_img_path)
    incorrect_img = pygame.transform.scale(correct_img, (300, 300))
    incorrect_img = pygame.image.load(incorrect_img_path)
    incorrect_img = pygame.transform.scale(incorrect_img, (300, 300))

    if correct_side == "left":
        left_img, right_img = correct_img, incorrect_img
        correct_choice = "left"
    else:
        left_img, right_img = incorrect_img, correct_img
        correct_choice = "right"

    display_game_info(current_round)

    left_rect = screen.blit(left_img, (75, 150))
    right_rect = screen.blit(right_img, (WIDTH - 375, 150))
    pygame.display.flip()

    clicked = False
    while not clicked:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                running = False
                clicked = True
                break

            if event.type == pygame.MOUSEBUTTONDOWN:
                mouse_pos = pygame.mouse.get_pos()
                if left_rect.collidepoint(mouse_pos):
                    if correct_choice == "left":
                        correct_sound.play()
                        score += 10
                        show_feedback(True, score)
                    else:
                        wrong_sound.play()
                        score -= 10
                        show_feedback(False, score)
                    current_round += 1
                    clicked = True
                    break
                elif right_rect.collidepoint(mouse_pos):
                    if correct_choice == "right":
                        correct_sound.play()
                        score += 10
                        show_feedback(True, score)
                    else:
                        wrong_sound.play()
                        score -= 10
                        show_feedback(False, score)
                    current_round += 1
                    clicked = True
                    break
        clock.tick(FPS)

if running:
    show_score()

pygame.quit()
sys.exit()
